NEAR application layer running with Tendermint consensus.

## Running locally

To run NEAR locally you would need docker, see [installation instructions](https://www.docker.com/get-started).
Then run the following:
```bash
./ops/deploy_local.sh
```

After it starts you can open studio at [http://localhost](http://localhost).

To tear it down run:
```bash
./ops/teardown_local.sh
```

Note, it is not advised to run more than two nodes locally, especially on low performance machines. While the network
itself is able to function and produce blocks, the development tools might currently timeout on certain commands,
because the nodes do not produce blocks fast enough.

## Running remotely
Similarly you deploy the network to the GCloud:
```bash
./ops/deploy_remote.sh
```
When the network is deployed it will print the address of the studio.

## Developing NEAR Runtime
This section is for those who want to develop the NEAR Runtime. If you only want to develop dApps then the above sections suffice.
Developing NEAR Runtime locally requires more installation and configuration.

### Installation

This mode of running requires compilation of the Rust code and installed Tendermint.

**1. Dependencies**

Install protobufs:
```bash
# Mac OS:
brew install protobuf

# Ubuntu:
apt-get install protobuf-compiler
```

**2. Rust**

Currently, the only way to install NEARMint application layer is to compile it from the source.
For that we would need to install Rust.

```bash
curl https://sh.rustup.rs -sSf | sh
rustup default nightly
```


**3. Source code**

We would need to copy the entire repository:

```bash
git clone https://github.com/nearprotocol/nearcore
cd nearcore
```

**4. Tendermint**

Follow the official instructions to install Tendermint: https://tendermint.com/docs/introduction/install.html

### Configure and run

To configure Tendermint run:

```bash
tendermint init
```

Configure Tendermint to use `3030` for its RPC. Open `~/.tendermint/config/config.toml` and change:
```yaml
[rpc]
laddr = "tcp://0.0.0.0:3030"
```

For local development we also recommend setting:
```yaml
create_empty_blocks = false
```

First, we want to set `alice.near` as a single validator. Open `~/.tendermint/config/priv_validator_key.json` and replace with:

```json
{
  "address": "27B2B6C138DDF7B77E4318A22CAE1A38F55AA29A",
  "pub_key": {
    "type": "tendermint/PubKeyEd25519",
    "value": "D1al8CjfwInsfDnBGDsyG02Pibpb7J4XYoA8wkkfbvg="
  },
  "priv_key": {
    "type": "tendermint/PrivKeyEd25519",
    "value": "YWxpY2UubmVhciAgICAgICAgICAgICAgICAgICAgICAPVqXwKN/Aiex8OcEYOzIbTY+JulvsnhdigDzCSR9u+A=="
  }
}
```

Navigate to the root of the repository, and run:
```bash
cargo run --package nearmint -- --devnet
```

This will start NEARMint in application mode, without consensus backing it up.

To start Tendermint run:
```bash
tendermint node
```

Now we can issue specific commands to the node:
```bash
curl http://localhost:3030/status
curl -s 'localhost:3030/abci_query?path="account/alice.near"'
curl -s 'localhost:3030/validators'
```

See full list of RPC endpoints here: https://tendermint.com/rpc/#endpoints

Unfortunately, transactions can be only submitted in base64 encoding, which is hard to do from the command line.
