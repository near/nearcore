# Replay

The replay script is able to take a dumped genesis file and a list of dumped tx traces, and set up a new localnet. 

Once the new localnet is launched (separately), the transaction traces can then be sent to the localnet node by this script.

Prerequisites:

* `[PREREQ1]` path of a dumped genesis file representing a state (generated by `dump_state`)

* `[PREREQ2]` path of a dumped transaction trace (generated by `dump_tx`)

* `[PREREQ3]` a localnet home path containing directory `node0/`, under which a valid `config.json` file exists for localnet use


In order to set up and launch replay, we take the following steps:

Make sure you have the right enviroment variables:
```shell
export PYTHONPATH=./pytest/lib
```

First, build the binary.
```shell
cargo build -p neard --release
```

Second, run `generate`:
```shell
python3 pytest/tests/replay/replay.py generate --genesis [PREREQ1] --home-dir [PREREQ3]
```

Third, launch the localnet node using outputs from `generate` under `--home-dir`. Hints on the screen.

Fourth, run `send`:
```shell
python3 pytest/tests/replay/replay.py send --tx-json [PREREQ2] --home-dir [PREREQ3]
```

Now the localnet db contains a dense trace of the txs dumped, replayed on the dumped genesis.
