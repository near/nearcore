[package]
name = "near-vm"
version = "0.0.0"
description = "High-performance WebAssembly runtime"
categories = ["wasm"]
keywords = ["wasm", "webassembly", "runtime", "vm"]
authors = ["Wasmer Engineering Team <engineering@wasmer.io>", "Near Inc <hello@nearprotocol.com>"]
repository = "https://github.com/wasmerio/wasmer"
license = "MIT"
readme = "README.md"
edition = "2021"
publish = false

[lib]
name = "wasmer"

# Shared dependencies.
[dependencies]
# - Mandatory shared dependencies.
cfg-if = "1.0"
finite-wasm = "0.3.0"
indexmap = { version = "1.6" }
more-asserts = "0.2"
prefix-sum-vec = "0.1.2"
thiserror = "1.0"
tracing = "0.1"

# - Optional shared dependencies.
wat = { version = "1.0", optional = true }

# Dependencies and Development Dependencies for `sys`.
[target.'cfg(not(target_arch = "wasm32"))'.dependencies]
# - Mandatory dependencies for `sys`.
wasmer-vm = { path = "../vm", package = "near-vm-vm" }
wasmer-compiler = { path = "../compiler", package = "near-vm-compiler" }
wasmer-engine = { path = "../engine", package = "near-vm-engine" }
wasmer-types = { path = "../types", package = "near-vm-types" }
target-lexicon = { version = "0.12.2", default-features = false }
# - Optional dependencies for `sys`.
wasmer-compiler-singlepass = { path = "../compiler-singlepass", package = "near-vm-compiler-singlepass", optional = true}
wasmer-engine-universal = { path = "../engine-universal", package = "near-vm-engine-universal", optional = true }
# - Mandatory dependencies for `sys` on Windows.
[target.'cfg(all(not(target_arch = "wasm32"), target_os = "windows"))'.dependencies]
winapi = "0.3"
# - Development Dependencies for `sys`.
[target.'cfg(not(target_arch = "wasm32"))'.dev-dependencies]
wat = "1.0"
tempfile = "3.1"
anyhow = "1.0"

[badges]
maintenance = { status = "actively-developed" }

[features]
default = ["sys-default"]
std = []
core = []

# Features for `sys`.
sys = []
sys-default = ["sys", "wat", "default-singlepass", "default-universal"]
# - Compilers.
compiler = [
    "sys",
    "wasmer-compiler/translator",
    "wasmer-engine-universal/compiler",
]
    singlepass = [
        "compiler",
        "wasmer-compiler-singlepass",
    ]
default-compiler = []
    default-singlepass = [
        "default-compiler",
        "singlepass",
    ]
# - Engines.
engine = ["sys"]
    universal = [
        "engine",
        "wasmer-engine-universal",
    ]
default-engine = []
    default-universal = [
        "default-engine",
        "universal",
    ]

[package.metadata.docs.rs]
features = ["compiler", "core", "default-compiler", "default-engine", "engine", "jit", "native", "singlepass", "sys", "sys-default", "universal"]
